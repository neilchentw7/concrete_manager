diff --git a/admin.html b/admin.html
index cfdeeddf7833792f5a6c567018c526d38743a850..ac8aa8baad783e453440a91b697fd855dfdf0919 100644
--- a/admin.html
+++ b/admin.html
@@ -93,51 +93,51 @@
                     <div class="table-wrapper"><table><thead><tr><th>ä»£è™Ÿ</th><th>åç¨±</th><th>é è¨­è·é›¢</th><th>çŸ­è¼‰é–€æª»</th><th>çŸ­è¼‰è£œè²¼</th><th>ç‹€æ…‹</th><th>æ“ä½œ</th></tr></thead><tbody id="projects-table"></tbody></table></div>
                 </div>
             </div>
             
             <!-- è»Šè¼›ç®¡ç† -->
             <div id="page-trucks" class="page">
                 <div class="page-header"><h2>è»Šè¼›ç®¡ç†</h2><button class="btn btn-primary" onclick="openTruckModal()">â• æ–°å¢è»Šè¼›</button></div>
                 <div class="card">
                     <div class="search-box"><input type="text" id="truck-search" placeholder="æœå°‹è»Šè™Ÿæˆ–å¸æ©Ÿ..." oninput="filterTrucks()"></div>
                     <div class="table-wrapper"><table><thead><tr><th>ä»£è™Ÿ</th><th>è»Šç‰Œ</th><th>å¸æ©Ÿ</th><th>é›»è©±</th><th>é è¨­è¼‰é‡</th><th>æ²¹è€—</th><th>æ¯è¶Ÿè–ªè³‡</th><th>ç‹€æ…‹</th><th>æ“ä½œ</th></tr></thead><tbody id="trucks-table"></tbody></table></div>
                 </div>
             </div>
             
             <!-- ææ–™å–®åƒ¹ -->
             <div id="page-materials" class="page">
                 <div class="page-header"><h2>ææ–™å–®åƒ¹</h2><button class="btn btn-primary" onclick="openMaterialModal()">â• æ–°å¢ææ–™å–®åƒ¹</button></div>
                 <div class="card">
                     <div class="table-wrapper"><table><thead><tr><th>ä»£ç¢¼</th><th>åç¨±</th><th class="num">ç ‚ $/kg</th><th class="num">çŸ³ $/kg</th><th class="num">æ°´æ³¥ $/kg</th><th class="num">çˆçŸ³ $/kg</th><th class="num">é£›ç° $/kg</th><th class="num">è—¥åŠ‘ $/kg</th><th>ç‹€æ…‹</th><th>æ“ä½œ</th></tr></thead><tbody id="materials-table"></tbody></table></div>
                 </div>
             </div>
             
             <!-- é…æ¯”ç®¡ç† -->
             <div id="page-mixes" class="page">
                 <div class="page-header"><h2>é…æ¯”ç®¡ç†</h2><button class="btn btn-primary" onclick="openMixModal()">â• æ–°å¢é…æ¯”</button></div>
                 <div class="card">
-                    <div class="search-box"><select id="mix-psi-filter" onchange="filterMixes()"><option value="">å…¨éƒ¨å¼·åº¦</option><option value="2000">2000 PSI</option><option value="3000">3000 PSI</option><option value="4000">4000 PSI</option></select></div>
+                    <div class="search-box"><select id="mix-psi-filter" onchange="filterMixes()"><option value="">å…¨éƒ¨å¼·åº¦</option></select></div>
                     <div class="table-wrapper"><table><thead><tr><th>ä»£è™Ÿ</th><th>PSI</th><th>åç¨±</th><th class="num">ç ‚1</th><th class="num">ç ‚2</th><th class="num">çŸ³1</th><th class="num">çŸ³2</th><th class="num">æ°´æ³¥</th><th class="num">çˆçŸ³</th><th class="num">é£›ç°</th><th class="num">è—¥åŠ‘</th><th class="num">æˆæœ¬/mÂ³</th><th>ç‹€æ…‹</th><th>æ“ä½œ</th></tr></thead><tbody id="mixes-table"></tbody></table></div>
                 </div>
             </div>
             
             <!-- å·¥ç¨‹å–®åƒ¹ -->
             <div id="page-prices" class="page">
                 <div class="page-header"><h2>å·¥ç¨‹å–®åƒ¹</h2><button class="btn btn-primary" onclick="openPriceModal()">â• æ–°å¢å–®åƒ¹</button></div>
                 <div class="card">
                     <div class="search-box"><select id="price-project-filter" onchange="loadPrices()"><option value="">-- å…¨éƒ¨å·¥ç¨‹ --</option></select></div>
                     <div class="table-wrapper"><table><thead><tr><th>å·¥ç¨‹</th><th>é…æ¯”</th><th class="num">å–®åƒ¹/mÂ³</th><th>ç”Ÿæ•ˆæ—¥</th><th>ç‹€æ…‹</th><th>æ“ä½œ</th></tr></thead><tbody id="prices-table"></tbody></table></div>
                 </div>
             </div>
             
             <!-- ç³»çµ±è¨­å®š -->
             <div id="page-settings" class="page">
                 <div class="page-header"><h2>ç³»çµ±è¨­å®š</h2></div>
                 <div class="card">
                     <div class="form-grid">
                         <div class="form-group"><label>æ²¹åƒ¹ (å…ƒ/å…¬å‡)</label><input type="number" id="setting-fuel_price" step="0.1"></div>
                         <div class="form-group"><label>é è¨­å¼·åº¦ (PSI)</label><input type="number" id="setting-default_psi"></div>
                         <div class="form-group"><label>é è¨­è¼‰é‡ (mÂ³)</label><input type="number" id="setting-default_load_m3" step="0.1"></div>
                     </div>
                     <div style="margin-top: 25px;"><button class="btn btn-success" onclick="saveSettings()">ğŸ’¾ å„²å­˜è¨­å®š</button></div>
                 </div>
             </div>
@@ -269,188 +269,215 @@
                 document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
                 item.classList.add('active');
                 document.getElementById('page-' + item.dataset.page).classList.add('active');
             });
         });
         
         function showToast(msg, type='success') {
             const t = document.createElement('div');
             t.className = `toast toast-${type}`;
             t.textContent = msg;
             document.body.appendChild(t);
             setTimeout(() => t.remove(), 3000);
         }
         
         function closeModal(id) { document.getElementById(id).classList.remove('show'); }
         
         // å·¥ç¨‹
         async function loadProjects() {
             const res = await fetch(`${API}/api/projects?active_only=false`);
             projectsData = await res.json();
             renderProjects(projectsData);
             document.getElementById('price-project-filter').innerHTML = '<option value="">-- å…¨éƒ¨ --</option>' + projectsData.filter(p=>p.is_active).map(p=>`<option value="${p.id}">${p.code} - ${p.name}</option>`).join('');
             document.getElementById('price-project').innerHTML = projectsData.filter(p=>p.is_active).map(p=>`<option value="${p.id}">${p.code} - ${p.name}</option>`).join('');
         }
         function renderProjects(data) {
-            document.getElementById('projects-table').innerHTML = data.map(p=>`<tr><td><strong>${p.code}</strong></td><td>${p.name}</td><td class="num">${p.default_distance_km} km</td><td class="num">${p.subsidy_threshold_m3} mÂ³</td><td class="num">$${p.subsidy_amount}</td><td><span class="badge ${p.is_active?'badge-success':'badge-danger'}">${p.is_active?'å•Ÿç”¨':'åœç”¨'}</span></td><td class="action-btns"><button class="btn btn-sm btn-secondary" onclick="editProject(${p.id})">ç·¨è¼¯</button><button class="btn btn-sm ${p.is_active?'btn-danger':'btn-success'}" onclick="toggleProject(${p.id},${!p.is_active})">${p.is_active?'åœç”¨':'å•Ÿç”¨'}</button></td></tr>`).join('');
+            document.getElementById('projects-table').innerHTML = data.map(p=>`<tr><td><strong>${p.code}</strong></td><td>${p.name}</td><td class="num">${p.default_distance_km} km</td><td class="num">${p.subsidy_threshold_m3} mÂ³</td><td class="num">$${p.subsidy_amount}</td><td><span class="badge ${p.is_active?'badge-success':'badge-danger'}">${p.is_active?'å•Ÿç”¨':'åœç”¨'}</span></td><td class="action-btns"><button class="btn btn-sm btn-secondary" onclick="editProject(${p.id})">ç·¨è¼¯</button><button class="btn btn-sm ${p.is_active?'btn-danger':'btn-success'}" onclick="toggleProject(${p.id},${!p.is_active})">${p.is_active?'åœç”¨':'å•Ÿç”¨'}</button><button class="btn btn-sm btn-danger" onclick="deleteProject(${p.id})">åˆªé™¤</button></td></tr>`).join('');
         }
         function filterProjects() { const k=document.getElementById('project-search').value.toLowerCase(); renderProjects(projectsData.filter(p=>p.code.toLowerCase().includes(k)||p.name.toLowerCase().includes(k))); }
         function openProjectModal(p=null) {
             document.getElementById('project-modal-title').textContent = p?'ç·¨è¼¯å·¥ç¨‹':'æ–°å¢å·¥ç¨‹';
             document.getElementById('project-id').value = p?.id||'';
             document.getElementById('project-code').value = p?.code||'';
             document.getElementById('project-code').disabled = !!p;
             document.getElementById('project-name').value = p?.name||'';
             document.getElementById('project-address').value = p?.address||'';
             document.getElementById('project-contact-name').value = p?.contact_name||'';
             document.getElementById('project-contact-phone').value = p?.contact_phone||'';
             document.getElementById('project-distance').value = p?.default_distance_km||10;
             document.getElementById('project-subsidy-threshold').value = p?.subsidy_threshold_m3||6;
             document.getElementById('project-subsidy-amount').value = p?.subsidy_amount||500;
             document.getElementById('project-modal').classList.add('show');
         }
         async function editProject(id) { const res=await fetch(`${API}/api/projects/${id}`); openProjectModal(await res.json()); }
+        async function deleteProject(id) {
+            if(!confirm('ç¢ºèªåˆªé™¤æ­¤å·¥ç¨‹ï¼Ÿ')) return;
+            const res=await fetch(`${API}/api/projects/${id}`,{method:'DELETE'});
+            if(res.ok){const r=await res.json();showToast(r.message||'å·²åˆªé™¤');loadProjects();}else{showToast('åˆªé™¤å¤±æ•—','error');}
+        }
         async function saveProject() {
             const id=document.getElementById('project-id').value;
             const data={code:document.getElementById('project-code').value,name:document.getElementById('project-name').value,address:document.getElementById('project-address').value,contact_name:document.getElementById('project-contact-name').value,contact_phone:document.getElementById('project-contact-phone').value,default_distance_km:parseFloat(document.getElementById('project-distance').value),subsidy_threshold_m3:parseFloat(document.getElementById('project-subsidy-threshold').value),subsidy_amount:parseFloat(document.getElementById('project-subsidy-amount').value)};
             const res=await fetch(id?`${API}/api/projects/${id}`:`${API}/api/projects`,{method:id?'PUT':'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(data)});
             if(res.ok){showToast(id?'å·²æ›´æ–°':'å·²æ–°å¢');closeModal('project-modal');loadProjects();}else{showToast((await res.json()).detail||'å¤±æ•—','error');}
         }
         async function toggleProject(id,active) { const p=projectsData.find(x=>x.id===id); await fetch(`${API}/api/projects/${id}`,{method:'PUT',headers:{'Content-Type':'application/json'},body:JSON.stringify({...p,is_active:active})}); showToast(active?'å·²å•Ÿç”¨':'å·²åœç”¨'); loadProjects(); }
         
         // è»Šè¼›
         async function loadTrucks() { const res=await fetch(`${API}/api/trucks?active_only=false`); trucksData=await res.json(); renderTrucks(trucksData); }
-        function renderTrucks(data) { document.getElementById('trucks-table').innerHTML = data.map(t=>`<tr><td><strong>${t.code}</strong></td><td>${t.plate_no}</td><td>${t.driver_name||'-'}</td><td>${t.driver_phone||'-'}</td><td class="num">${t.default_load_m3} mÂ³</td><td class="num">${t.fuel_l_per_km}</td><td class="num">$${t.driver_pay_per_trip}</td><td><span class="badge ${t.is_active?'badge-success':'badge-danger'}">${t.is_active?'å•Ÿç”¨':'åœç”¨'}</span></td><td class="action-btns"><button class="btn btn-sm btn-secondary" onclick="editTruck(${t.id})">ç·¨è¼¯</button></td></tr>`).join(''); }
+        function renderTrucks(data) { document.getElementById('trucks-table').innerHTML = data.map(t=>`<tr><td><strong>${t.code}</strong></td><td>${t.plate_no}</td><td>${t.driver_name||'-'}</td><td>${t.driver_phone||'-'}</td><td class="num">${t.default_load_m3} mÂ³</td><td class="num">${t.fuel_l_per_km}</td><td class="num">$${t.driver_pay_per_trip}</td><td><span class="badge ${t.is_active?'badge-success':'badge-danger'}">${t.is_active?'å•Ÿç”¨':'åœç”¨'}</span></td><td class="action-btns"><button class="btn btn-sm btn-secondary" onclick="editTruck(${t.id})">ç·¨è¼¯</button><button class="btn btn-sm btn-danger" onclick="deleteTruck(${t.id})">åˆªé™¤</button></td></tr>`).join(''); }
         function filterTrucks() { const k=document.getElementById('truck-search').value.toLowerCase(); renderTrucks(trucksData.filter(t=>t.plate_no.toLowerCase().includes(k)||(t.driver_name&&t.driver_name.toLowerCase().includes(k)))); }
         function openTruckModal(t=null) {
             document.getElementById('truck-modal-title').textContent = t?'ç·¨è¼¯è»Šè¼›':'æ–°å¢è»Šè¼›';
             document.getElementById('truck-id').value = t?.id||'';
             document.getElementById('truck-code').value = t?.code||'';
             document.getElementById('truck-code').disabled = !!t;
             document.getElementById('truck-plate').value = t?.plate_no||'';
             document.getElementById('truck-driver-name').value = t?.driver_name||'';
             document.getElementById('truck-driver-phone').value = t?.driver_phone||'';
             document.getElementById('truck-load').value = t?.default_load_m3||8;
             document.getElementById('truck-fuel').value = t?.fuel_l_per_km||0.5;
             document.getElementById('truck-pay').value = t?.driver_pay_per_trip||800;
             document.getElementById('truck-modal').classList.add('show');
         }
         async function editTruck(id) { const res=await fetch(`${API}/api/trucks/${id}`); openTruckModal(await res.json()); }
         async function saveTruck() {
             const id=document.getElementById('truck-id').value;
             const data={code:document.getElementById('truck-code').value,plate_no:document.getElementById('truck-plate').value,driver_name:document.getElementById('truck-driver-name').value,driver_phone:document.getElementById('truck-driver-phone').value,default_load_m3:parseFloat(document.getElementById('truck-load').value),fuel_l_per_km:parseFloat(document.getElementById('truck-fuel').value),driver_pay_per_trip:parseFloat(document.getElementById('truck-pay').value)};
             const res=await fetch(id?`${API}/api/trucks/${id}`:`${API}/api/trucks`,{method:id?'PUT':'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(data)});
             if(res.ok){showToast(id?'å·²æ›´æ–°':'å·²æ–°å¢');closeModal('truck-modal');loadTrucks();}else{showToast((await res.json()).detail||'å¤±æ•—','error');}
         }
+        async function deleteTruck(id) {
+            if(!confirm('ç¢ºèªåˆªé™¤æ­¤è»Šè¼›ï¼Ÿ')) return;
+            const res=await fetch(`${API}/api/trucks/${id}`,{method:'DELETE'});
+            if(res.ok){const r=await res.json();showToast(r.message||'å·²åˆªé™¤');loadTrucks();}else{showToast('åˆªé™¤å¤±æ•—','error');}
+        }
         
         // ææ–™å–®åƒ¹
         async function loadMaterials() {
             const res=await fetch(`${API}/api/material-prices?active_only=false`);
             materialsData=await res.json();
             renderMaterials(materialsData);
             document.getElementById('mix-material-price').innerHTML = '<option value="">-- ä¸ä½¿ç”¨ --</option>' + materialsData.filter(m=>m.is_active).map(m=>`<option value="${m.id}">${m.price_id} - ${m.name||''}</option>`).join('');
         }
-        function renderMaterials(data) { document.getElementById('materials-table').innerHTML = data.map(m=>`<tr><td><strong>${m.price_id}</strong></td><td>${m.name||'-'}</td><td class="num">${m.sand_price.toFixed(4)}</td><td class="num">${m.stone_price.toFixed(4)}</td><td class="num">${m.cement_price.toFixed(4)}</td><td class="num">${m.slag_price.toFixed(4)}</td><td class="num">${m.flyash_price.toFixed(4)}</td><td class="num">${m.admixture_price.toFixed(4)}</td><td><span class="badge ${m.is_active?'badge-success':'badge-danger'}">${m.is_active?'å•Ÿç”¨':'åœç”¨'}</span></td><td class="action-btns"><button class="btn btn-sm btn-secondary" onclick="editMaterial(${m.id})">ç·¨è¼¯</button><button class="btn btn-sm btn-warning" onclick="recalcMixes(${m.id})">é‡ç®—</button></td></tr>`).join(''); }
+        function renderMaterials(data) { document.getElementById('materials-table').innerHTML = data.map(m=>`<tr><td><strong>${m.price_id}</strong></td><td>${m.name||'-'}</td><td class="num">${m.sand_price.toFixed(4)}</td><td class="num">${m.stone_price.toFixed(4)}</td><td class="num">${m.cement_price.toFixed(4)}</td><td class="num">${m.slag_price.toFixed(4)}</td><td class="num">${m.flyash_price.toFixed(4)}</td><td class="num">${m.admixture_price.toFixed(4)}</td><td><span class="badge ${m.is_active?'badge-success':'badge-danger'}">${m.is_active?'å•Ÿç”¨':'åœç”¨'}</span></td><td class="action-btns"><button class="btn btn-sm btn-secondary" onclick="editMaterial(${m.id})">ç·¨è¼¯</button><button class="btn btn-sm btn-warning" onclick="recalcMixes(${m.id})">é‡ç®—</button><button class="btn btn-sm btn-danger" onclick="deleteMaterial(${m.id})">åˆªé™¤</button></td></tr>`).join(''); }
         function openMaterialModal(m=null) {
             document.getElementById('material-modal-title').textContent = m?'ç·¨è¼¯ææ–™å–®åƒ¹':'æ–°å¢ææ–™å–®åƒ¹';
             document.getElementById('material-id').value = m?.id||'';
             document.getElementById('material-price-id').value = m?.price_id||'';
             document.getElementById('material-price-id').disabled = !!m;
             document.getElementById('material-name').value = m?.name||'';
             document.getElementById('material-sand').value = m?.sand_price||0;
             document.getElementById('material-stone').value = m?.stone_price||0;
             document.getElementById('material-cement').value = m?.cement_price||0;
             document.getElementById('material-slag').value = m?.slag_price||0;
             document.getElementById('material-flyash').value = m?.flyash_price||0;
             document.getElementById('material-admixture').value = m?.admixture_price||0;
             document.getElementById('material-modal').classList.add('show');
         }
         async function editMaterial(id) { const res=await fetch(`${API}/api/material-prices/${id}`); openMaterialModal(await res.json()); }
         async function saveMaterial() {
             const id=document.getElementById('material-id').value;
             const data={price_id:document.getElementById('material-price-id').value,name:document.getElementById('material-name').value,sand_price:parseFloat(document.getElementById('material-sand').value),stone_price:parseFloat(document.getElementById('material-stone').value),cement_price:parseFloat(document.getElementById('material-cement').value),slag_price:parseFloat(document.getElementById('material-slag').value),flyash_price:parseFloat(document.getElementById('material-flyash').value),admixture_price:parseFloat(document.getElementById('material-admixture').value)};
             const res=await fetch(id?`${API}/api/material-prices/${id}`:`${API}/api/material-prices`,{method:id?'PUT':'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(data)});
             if(res.ok){showToast(id?'å·²æ›´æ–°':'å·²æ–°å¢');closeModal('material-modal');loadMaterials();}else{showToast((await res.json()).detail||'å¤±æ•—','error');}
         }
         async function recalcMixes(mpId) { if(!confirm('ç¢ºå®šè¦é‡ç®—é…æ¯”æˆæœ¬?'))return; const res=await fetch(`${API}/api/material-prices/${mpId}/recalc-mixes`,{method:'POST'}); const r=await res.json(); showToast(`å·²æ›´æ–° ${r.updated} å€‹é…æ¯”`); loadMixes(); }
+        async function deleteMaterial(id) {
+            if(!confirm('ç¢ºèªåˆªé™¤æ­¤ææ–™å–®åƒ¹ï¼Ÿ')) return;
+            const res=await fetch(`${API}/api/material-prices/${id}`,{method:'DELETE'});
+            if(res.ok){const r=await res.json();showToast(r.message||'å·²åˆªé™¤');loadMaterials();}else{showToast('åˆªé™¤å¤±æ•—','error');}
+        }
         
         // é…æ¯”
         async function loadMixes() {
             const res=await fetch(`${API}/api/mixes?active_only=false`);
             mixesData=await res.json();
             renderMixes(mixesData);
             document.getElementById('price-mix').innerHTML = mixesData.filter(m=>m.is_active).map(m=>`<option value="${m.id}">${m.psi} PSI - ${m.name||m.code}</option>`).join('');
+            const psiOptions=[...new Set(mixesData.map(m=>m.psi))].sort((a,b)=>a-b).map(v=>`<option value="${v}">${v} PSI</option>`).join('');
+            document.getElementById('mix-psi-filter').innerHTML = '<option value="">å…¨éƒ¨å¼·åº¦</option>' + psiOptions;
         }
-        function renderMixes(data) { document.getElementById('mixes-table').innerHTML = data.map(m=>`<tr><td><strong>${m.code}</strong></td><td>${m.psi}</td><td>${m.name||'-'}</td><td class="num">${m.sand1_kg}</td><td class="num">${m.sand2_kg}</td><td class="num">${m.stone1_kg}</td><td class="num">${m.stone2_kg}</td><td class="num">${m.cement_kg}</td><td class="num">${m.slag_kg}</td><td class="num">${m.flyash_kg}</td><td class="num">${m.admixture_kg}</td><td class="num"><strong>$${m.material_cost_per_m3.toFixed(2)}</strong></td><td><span class="badge ${m.is_active?'badge-success':'badge-danger'}">${m.is_active?'å•Ÿç”¨':'åœç”¨'}</span></td><td class="action-btns"><button class="btn btn-sm btn-secondary" onclick="editMix(${m.id})">ç·¨è¼¯</button></td></tr>`).join(''); }
+        function renderMixes(data) { document.getElementById('mixes-table').innerHTML = data.map(m=>`<tr><td><strong>${m.code}</strong></td><td>${m.psi}</td><td>${m.name||'-'}</td><td class="num">${m.sand1_kg}</td><td class="num">${m.sand2_kg}</td><td class="num">${m.stone1_kg}</td><td class="num">${m.stone2_kg}</td><td class="num">${m.cement_kg}</td><td class="num">${m.slag_kg}</td><td class="num">${m.flyash_kg}</td><td class="num">${m.admixture_kg}</td><td class="num"><strong>$${m.material_cost_per_m3.toFixed(2)}</strong></td><td><span class="badge ${m.is_active?'badge-success':'badge-danger'}">${m.is_active?'å•Ÿç”¨':'åœç”¨'}</span></td><td class="action-btns"><button class="btn btn-sm btn-secondary" onclick="editMix(${m.id})">ç·¨è¼¯</button><button class="btn btn-sm btn-danger" onclick="deleteMix(${m.id})">åˆªé™¤</button></td></tr>`).join(''); }
         function filterMixes() { const psi=document.getElementById('mix-psi-filter').value; renderMixes(psi?mixesData.filter(m=>m.psi==psi):mixesData); }
         function openMixModal(m=null) {
             document.getElementById('mix-modal-title').textContent = m?'ç·¨è¼¯é…æ¯”':'æ–°å¢é…æ¯”';
             document.getElementById('mix-id').value = m?.id||'';
             document.getElementById('mix-code').value = m?.code||'';
             document.getElementById('mix-code').disabled = !!m;
             document.getElementById('mix-psi').value = m?.psi||'';
             document.getElementById('mix-name').value = m?.name||'';
             document.getElementById('mix-material-price').value = m?.material_price_id||'';
             document.getElementById('mix-sand1').value = m?.sand1_kg||0;
             document.getElementById('mix-sand2').value = m?.sand2_kg||0;
             document.getElementById('mix-stone1').value = m?.stone1_kg||0;
             document.getElementById('mix-stone2').value = m?.stone2_kg||0;
             document.getElementById('mix-cement').value = m?.cement_kg||0;
             document.getElementById('mix-slag').value = m?.slag_kg||0;
             document.getElementById('mix-flyash').value = m?.flyash_kg||0;
             document.getElementById('mix-admixture').value = m?.admixture_kg||0;
             document.getElementById('mix-cost-preview').style.display = 'none';
             document.getElementById('mix-modal').classList.add('show');
         }
         async function editMix(id) { const res=await fetch(`${API}/api/mixes/${id}`); const m=await res.json(); openMixModal(m); if(m.cost_breakdown)showCostBreakdown(m.cost_breakdown,m.material_cost_per_m3); }
         function previewMixCost() {
             const mpId=document.getElementById('mix-material-price').value;
             if(!mpId){showToast('è«‹é¸æ“‡ææ–™å–®åƒ¹','error');return;}
             const mp=materialsData.find(m=>m.id==mpId);if(!mp)return;
             const s1=parseFloat(document.getElementById('mix-sand1').value)||0, s2=parseFloat(document.getElementById('mix-sand2').value)||0;
             const st1=parseFloat(document.getElementById('mix-stone1').value)||0, st2=parseFloat(document.getElementById('mix-stone2').value)||0;
             const c=parseFloat(document.getElementById('mix-cement').value)||0, sl=parseFloat(document.getElementById('mix-slag').value)||0;
             const f=parseFloat(document.getElementById('mix-flyash').value)||0, a=parseFloat(document.getElementById('mix-admixture').value)||0;
             const bd={'ç ‚':{ç”¨é‡:s1+s2,å–®åƒ¹:mp.sand_price,å°è¨ˆ:(s1+s2)*mp.sand_price},'çŸ³':{ç”¨é‡:st1+st2,å–®åƒ¹:mp.stone_price,å°è¨ˆ:(st1+st2)*mp.stone_price},'æ°´æ³¥':{ç”¨é‡:c,å–®åƒ¹:mp.cement_price,å°è¨ˆ:c*mp.cement_price},'çˆçŸ³':{ç”¨é‡:sl,å–®åƒ¹:mp.slag_price,å°è¨ˆ:sl*mp.slag_price},'é£›ç°':{ç”¨é‡:f,å–®åƒ¹:mp.flyash_price,å°è¨ˆ:f*mp.flyash_price},'è—¥åŠ‘':{ç”¨é‡:a,å–®åƒ¹:mp.admixture_price,å°è¨ˆ:a*mp.admixture_price}};
             showCostBreakdown(bd,Object.values(bd).reduce((s,i)=>s+i['å°è¨ˆ'],0));
         }
         function showCostBreakdown(bd,total) {
             let h='';for(const[n,i]of Object.entries(bd))h+=`<div class="cost-row"><span>${n}: ${i['ç”¨é‡'].toFixed(2)} kg Ã— $${i['å–®åƒ¹'].toFixed(4)}</span><span>$${i['å°è¨ˆ'].toFixed(2)}</span></div>`;
             h+=`<div class="cost-row"><span>ç¸½æˆæœ¬</span><span>$${total.toFixed(2)}/mÂ³</span></div>`;
             document.getElementById('mix-cost-detail').innerHTML=h;
             document.getElementById('mix-cost-preview').style.display='block';
         }
         async function saveMix() {
             const id=document.getElementById('mix-id').value, mpId=document.getElementById('mix-material-price').value;
             const data={code:document.getElementById('mix-code').value,psi:parseInt(document.getElementById('mix-psi').value),name:document.getElementById('mix-name').value,material_price_id:mpId?parseInt(mpId):null,sand1_kg:parseFloat(document.getElementById('mix-sand1').value)||0,sand2_kg:parseFloat(document.getElementById('mix-sand2').value)||0,stone1_kg:parseFloat(document.getElementById('mix-stone1').value)||0,stone2_kg:parseFloat(document.getElementById('mix-stone2').value)||0,cement_kg:parseFloat(document.getElementById('mix-cement').value)||0,slag_kg:parseFloat(document.getElementById('mix-slag').value)||0,flyash_kg:parseFloat(document.getElementById('mix-flyash').value)||0,admixture_kg:parseFloat(document.getElementById('mix-admixture').value)||0,material_cost_per_m3:0};
             const res=await fetch(id?`${API}/api/mixes/${id}`:`${API}/api/mixes`,{method:id?'PUT':'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(data)});
             if(res.ok){const r=await res.json();showToast(id?`å·²æ›´æ–°ï¼Œæˆæœ¬: $${r.material_cost_per_m3?.toFixed(2)||'?'}/mÂ³`:'å·²æ–°å¢');closeModal('mix-modal');loadMixes();}else{showToast((await res.json()).detail||'å¤±æ•—','error');}
         }
+        async function deleteMix(id) {
+            if(!confirm('ç¢ºèªåˆªé™¤æ­¤é…æ¯”ï¼Ÿ')) return;
+            const res=await fetch(`${API}/api/mixes/${id}`,{method:'DELETE'});
+            if(res.ok){const r=await res.json();showToast(r.message||'å·²åˆªé™¤');loadMixes();}else{showToast('åˆªé™¤å¤±æ•—','error');}
+        }
         
         // å–®åƒ¹
         async function loadPrices() { const pid=document.getElementById('price-project-filter').value; const res=await fetch(`${API}/api/prices${pid?`?project_id=${pid}`:''}`); pricesData=await res.json(); renderPrices(pricesData); }
-        function renderPrices(data) { document.getElementById('prices-table').innerHTML = data.map(p=>`<tr><td>${p.project_name||p.project_code}</td><td>${p.mix_psi} PSI</td><td class="num"><strong>$${p.price_per_m3.toFixed(2)}</strong></td><td>${p.effective_from||'-'}</td><td><span class="badge ${p.is_active?'badge-success':'badge-danger'}">${p.is_active?'å•Ÿç”¨':'åœç”¨'}</span></td><td class="action-btns"><button class="btn btn-sm btn-secondary" onclick="editPrice(${p.id})">ç·¨è¼¯</button></td></tr>`).join(''); }
+        function renderPrices(data) { document.getElementById('prices-table').innerHTML = data.map(p=>`<tr><td>${p.project_name||p.project_code}</td><td>${p.mix_psi} PSI</td><td class="num"><strong>$${p.price_per_m3.toFixed(2)}</strong></td><td>${p.effective_from||'-'}</td><td><span class="badge ${p.is_active?'badge-success':'badge-danger'}">${p.is_active?'å•Ÿç”¨':'åœç”¨'}</span></td><td class="action-btns"><button class="btn btn-sm btn-secondary" onclick="editPrice(${p.id})">ç·¨è¼¯</button><button class="btn btn-sm btn-danger" onclick="deletePrice(${p.id})">åˆªé™¤</button></td></tr>`).join(''); }
         function openPriceModal(p=null) {
             document.getElementById('price-modal-title').textContent = p?'ç·¨è¼¯å–®åƒ¹':'æ–°å¢å–®åƒ¹';
             document.getElementById('price-id').value = p?.id||'';
             document.getElementById('price-project').value = p?.project_id||projectsData[0]?.id||'';
             document.getElementById('price-mix').value = p?.mix_id||mixesData[0]?.id||'';
             document.getElementById('price-amount').value = p?.price_per_m3||'';
             document.getElementById('price-effective-from').value = p?.effective_from||new Date().toISOString().split('T')[0];
             document.getElementById('price-modal').classList.add('show');
         }
         async function editPrice(id) { openPriceModal(pricesData.find(p=>p.id===id)); }
         async function savePrice() {
             const data={project_id:parseInt(document.getElementById('price-project').value),mix_id:parseInt(document.getElementById('price-mix').value),price_per_m3:parseFloat(document.getElementById('price-amount').value),effective_from:document.getElementById('price-effective-from').value||null};
             const res=await fetch(`${API}/api/prices`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(data)});
             if(res.ok){showToast('å·²å„²å­˜');closeModal('price-modal');loadPrices();}else{showToast((await res.json()).detail||'å¤±æ•—','error');}
         }
+        async function deletePrice(id) {
+            if(!confirm('ç¢ºèªåˆªé™¤æ­¤å–®åƒ¹ï¼Ÿ')) return;
+            const res=await fetch(`${API}/api/prices/${id}`,{method:'DELETE'});
+            if(res.ok){const r=await res.json();showToast(r.message||'å·²åˆªé™¤');loadPrices();}else{showToast('åˆªé™¤å¤±æ•—','error');}
+        }
         
         // è¨­å®š
         async function loadSettings() { const res=await fetch(`${API}/api/settings`); (await res.json()).forEach(s=>{const el=document.getElementById(`setting-${s.key}`);if(el)el.value=s.value;}); }
         async function saveSettings() { for(const k of['fuel_price','default_psi','default_load_m3'])await fetch(`${API}/api/settings/${k}`,{method:'PUT',headers:{'Content-Type':'application/json'},body:JSON.stringify({value:document.getElementById(`setting-${k}`).value})}); showToast('è¨­å®šå·²å„²å­˜'); }
         
         // åˆå§‹åŒ–
         (async()=>{await loadMaterials();await loadProjects();await loadTrucks();await loadMixes();await loadPrices();await loadSettings();})();
     </script>
 </body>
 </html>
